{"query_result": {"retrieved_at": "2020-04-28T06:15:13.199Z", "query_hash": "161ae01591fd2a2af40636a63c47dac2", "query": "with dau as (\r\n        select \r\n            transactiontime as activity_date,\r\n            merchantcode as user_id, \r\n            ammount,\r\n            ammount * 0.0299 - cast(income as FLOAT)as inc_amt\r\n        from cajero_web_javascript.transaction\r\n),\r\n\r\nfirst_dt as (\r\n        select \r\n            user_id, \r\n            date_trunc('day', min(activity_date))::date as first_day\r\n        from dau\r\n        group by 1\r\n),\r\n\r\nlast_ as (\r\n    select\r\n        date_trunc('month',max(activity_date))::date as last_day,\r\n        last_day-1 as frist_\r\n    from dau \r\n),\r\n\r\nmau_decorated as (\r\n        select\r\n            d.activity_date,\r\n            d.user_id,\r\n            d.ammount,\r\n            d.inc_amt,\r\n            f.first_day,\r\n            l.frist_\r\n        from dau d, first_dt f, last_ l\r\n        where d.user_id = f.user_id \r\n        and d.ammount > 0 \r\n),\r\n\r\n\r\nTotal as(\r\n    select \r\n        frist_ as LAST_DATE,\r\n        sum(inc_amt) as revenue,\r\n        sum(ammount) as Total,\r\n        count(activity_date) as Num_Tran,\r\n        count(distinct user_id) as Num_User\r\n    from mau_decorated\r\n    group by frist_\r\n)\r\n\r\nselect * from Total\r\n\r\n", "runtime": 0.0679218769073486, "data": {"rows": [{"num_tran": 109756, "last_date": "2020-03-31", "total": 15963046799.0, "num_user": 1474, "revenue": 170823037.7001}], "columns": [{"friendly_name": "last_date", "type": "date", "name": "last_date"}, {"friendly_name": "revenue", "type": "float", "name": "revenue"}, {"friendly_name": "total", "type": "float", "name": "total"}, {"friendly_name": "num_tran", "type": "integer", "name": "num_tran"}, {"friendly_name": "num_user", "type": "integer", "name": "num_user"}]}, "id": 3287, "data_source_id": 1}}
